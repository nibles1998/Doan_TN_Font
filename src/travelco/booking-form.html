<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from shmai.com/preview/travelco/booking-form.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 26 Sep 2018 04:24:06 GMT -->

<head>
    <!-- META -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="TravelCo - Travel Agency Bootstrap Template">
    <meta name="keywords" content=" new, html, bootstrap, new html template, design, creative, clean, modern">
    <meta name="author" content="Nauman Anwar">
    <!--PAGE FAVICON-->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.ico/favicon-32x32.png">
    <!-- PAGE TITLE -->
    <title>TravelCo</title>
    <!-- BOOTSTRAP CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- ALL GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,500,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Arimo" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <!-- FONT AWESOME CSS -->
    <link rel="stylesheet" href="assets/fonts/line-awesome-font-awesome.min.css">
    <!-- OWL CAROSEL CSS -->
    <link rel="stylesheet" href="assets/owlcarousel/css/owl.carousel.css">
    <link rel="stylesheet" href="assets/owlcarousel/css/owl.theme.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <!-- MAGNIFIC CSS -->
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <!-- ANIMATE CSS -->
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <!-- MAIN STYLE CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap-dropdownhover.css">
    <link rel="stylesheet" href="assets/css/venobox.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- RESPONSIVE CSS -->
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-star-rating/4.0.6/css/star-rating.min.css" media="all"
        rel="stylesheet" type="text/css" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <!-- START PRELOADER AREA-->
    <div class="preloader-area">
        <div class="spinner">
            <i class="fa fa-plane" aria-hidden="true"></i>
            <h2>TravelCo</h2>
        </div>
    </div>
    <!-- END PRELOADER AREA -->
    <!-- START HOMEPAGE DESIGN AREA -->
    <header id="home" class="welcome-area">
        <div class="header-top-area inner-page-htop">
            <div class="container">
                <div class="row">
                    <div class="col-md-3">
                        <!-- START LOGO DESIGN AREA -->
                        <div class="logo">
                            <a href="index.html">
                                <img class="innper-page-logo" src="assets/images/logo.png" alt="">
                            </a>
                        </div>
                        <!-- END LOGO DESIGN AREA -->
                    </div>
                    <div class="col-md-9">
                        <!-- START MENU DESIGN AREA -->
                        <div class="mainmenu">
                            <div class="navbar navbar-nobg">
                                <div class="navbar-header">
                                    <button type="button" class="navbar-toggle" data-toggle="collapse"
                                        data-target=".navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                    </button>
                                </div>
                                <div class="navbar-collapse collapse">
                                    <ul class="nav navbar-nav navbar-left">
                                        <li><a href="index.html">Home</a></li>
                                        <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle"
                                                href="#">Tour<span class="caret"></span></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="tours.html">List</a></li>
                                                <li><a href="activities.html">Activites</a></li>
                                            </ul>
                                        </li>
                                        <li><a class="smoth-scroll" href="about.html">About</a></li>
                                        <li><a href="contact.html">Contact</a></li>
                                    </ul>
                                    <div class="pull-right" style="margin-top: -1.5em;" id="login">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- END MENU DESIGN AREA -->
                    </div>
                </div>
            </div>
        </div>
        <!-- Start banner -->
        <div class="inner-page-header">
            <img src="assets/images/bg/bookingbg.jpg" alt="Inner Page Header" class="full-width">
            <div class="title-breadcrumb">
                <div class="container">
                    <div class="site-page-header clear-fix">
                        <div class="site-title">
                            <h2>Tours Details</h2>
                        </div>
                    </div>
                    <div class="site-page-breadcrumb">
                        <span>
                            Home > Tour Booking
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <section id="tour-booking" class="gray-area section-padding">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="booking-top" id="tourDetail">

                </div>
                <div class="book-detailstour ">
                    <div class="book-detialsinfo ">
                        <div class="col-md-6">
                            <h3>Book now</h3>
                        </div>
                    </div>
                    <form action="#" class="comment-form" id="booking-form" onsubmit="return booking(event)">
                        <div class="col-md-3">
                            <label for="availabledate">
                                available on
                            </label>
                            <input type="date" class="form-control mb-2 mr-sm-2" id="applyDate-booking"
                                name="applyDate" />
                        </div>
                        <div class="col-md-2">
                            <label>
                                adult
                            </label>
                            <select class="form-control mb-2 mr-sm-2" id="adult-booking" name="adult">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label>
                                kids
                            </label>
                            <select class="form-control mb-2 mr-sm-2" id="child-booking" name="child">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label>
                                Total Amount
                            </label>
                            <input class="form-control mb-2 mr-sm-2 " type="text" id="total-booking" name="total"
                                readonly />
                        </div>
                        <div class="col-md-3">
                            <input class="button mb-2 mr-sm-2 inline-book-btn" id="submitButton" type="submit"
                                name="submit" value="SEND" />
                        </div>
                    </form>
                </div>
            </div>
            <hr>
            <!-- Review -->
            <div>
                <!-- Form review -->
                <div id="formComment">

                </div>
                <hr>
                <!-- List all review -->
                <div id="listReview">

                </div>
            </div>
        </div>
    </section>

    <!-- Modal Delete -->
    <div class="modal fade" id="exampleModalCenter-Delete" tabindex="-1" role="dialog"
        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Delete Comment</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h3>Do you want delete?</h3>
                </div>
                <div class="modal-footer">
                    <button id="cancel-modal" type="button" class="btn btn-secondary"
                        data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" onclick="deleteComment()">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- START COMPANY DESIGN AREA -->
    <div class="company-logo-area  wow fadeInU">
        <div class="container">
            <div id="owl-brands" class="company-logo-list owl-carousel unicase-owl-carousel owl-outer-nav">
                <div class="item">
                    <div class="item_inner">
                        <img alt="image" src="assets/images/company-logo/company_1.png">
                    </div>

                </div>
                <!-- /.item -->
                <div class="item">
                    <div class="item_inner">
                        <img alt="image" src="assets/images/company-logo/company_2.png">
                    </div>
                </div>
                <!-- /.item -->
                <div class="item">
                    <div class="item_inner">
                        <img alt="image" src="assets/images/company-logo/company_3.png">
                    </div>
                </div>
                <!-- /.item -->
                <div class="item">
                    <div class="item_inner">
                        <img alt="image" src="assets/images/company-logo/company_4.png">
                    </div>
                </div>
                <!-- /.item -->
                <div class="item">
                    <div class="item_inner">
                        <img alt="image" src="assets/images/company-logo/company_5.png">
                    </div>
                </div>
            </div>
            <div class="owl-controls clickable">
                <div class="owl-buttons">
                    <div class="owl-prev"></div>
                    <div class="owl-next"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- / END COMPANY DESIGN AREA -->
    <!-- START FOOTER DESIGN AREA -->
    <footer>
        <div class="footer-bottom">
            <div class="container">
                <div class="row">
                    <div class="col-md-5">
                        <div class="footer-text left-align" style="text-align: left;color: white;">
                            <h4>Copyright &copy; TravelCo 2018. all rights Reserved</h4>
                        </div>
                    </div>
                    <div style="text-align: right;color: white;">
                        <i class="fa fa-map-marker" aria-hidden="true"></i> 14 Tottenham Court Road, NewYork<br />
                        <i class="fa fa-phone" aria-hidden="true"></i> 1(784)-775-95-377,
                        1(784)-678-26-567N<br />

                        <i class="fa fa-envelope-o" aria-hidden="true"></i>
                        <a href="#">info@yoursite.com/
                        </a><a href="">www.TravelCo.com</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- / END CONTACT DETAILS DESIGN AREA -->
    <!-- START SCROOL UP DESIGN AREA -->
    <div class="scroll-to-up">
        <div class="scrollup">
            <span class="fa fa-chevron-up"></span>
        </div>
    </div>
    <!-- / END SCROOL UP DESIGN AREA -->
    <!-- LATEST JQUERY -->
    <script src="assets/js/jquery.min.js"></script>
    <!-- BOOTSTRAP JS -->
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- OWL CAROUSEL JS  -->
    <script src="assets/owlcarousel/js/owl.carousel.mini.js"></script>
    <!-- MAGNIFICANT JS -->
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <!-- MAGNIFICANT JS -->
    <script src="assets/js/isotope.min.js"></script>
    <!--Image Loded JS-->
    <script src="assets/js/images-loded.min.js"></script>
    <!-- STEALLER JS -->
    <script src="assets/js/jquery.stellar.min.js"></script>
    <!-- WOW JS -->
    <script src="assets/js/wow.min.js"></script>
    <!-- CONTCAT FORM JS -->
    <script src="assets/js/form-contact.js"></script>
    <script src="assets/js/venobox.min.js"></script>
    <script src="assets/js/color-switcher.js"></script>
    <!-- scripts js -->
    <script src="assets/js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-star-rating/4.0.6/js/star-rating.min.js"
        type="text/javascript"></script>

    <!-- Script by me -->
    <script>
        $(document).ready(function () {
            const url = new URL(window.location.href);
            const searchParam = new URLSearchParams(url.search);
            const tourId = searchParam.get("id");
            const dataLogin = JSON.parse(localStorage.getItem("dataLoginClient"));
            let formComment = "";
            let str = "";
            if (!dataLogin) {
                str += `<div style="margin-top: 3.5em;" id="login-right">
                            <a href="login.html">Login</a>
                            <span style="border: 1px solid #fff; margin: 6px 0px;"></span>
                            <a href="register.html">Register</a>
                        </div>`;
                formComment += `
                        <form>
                            <div class="row">
                                <div style="text-align: center;" class="col-md-2">
                                    <img style="border-radius: 50%!important;max-height: 80px; border:2px solid lavender;"
                                        src="images/none_avatar.png">
                                    <p><b>None Login</b></p>
                                    <div class="rating" style="max-height:50px;">
                                        <input type="radio" name="rating-create" value="5" id="five-star-create">
                                        <label for="five-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="4" id="four-star-create">
                                        <label for="four-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="3" id="three-star-create">
                                        <label for="three-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="2" id="two-star-create">
                                        <label for="two-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="1" id="one-star-create">
                                        <label for="one-star-create"><span>&#9733</span></label>
                                    </div>
                                </div>
                                <div class="col-md-10">
                                    <textarea id="userComment-create" class="form-control ng-pristine ng-invalid ng-touched"></textarea>
                                    <button class="btn btn-primary" type="button" onclick="comment()">Comment</button>
                                </div>
                            </div>
                        </form>
                `;
                $("#login").html(str);
                $("#formComment").html(formComment);
                $(`#one-star-create`).prop('checked', true);
                const apiUrlReviewAll = 'http://api.nibles-tour.ga/review/s';
                $.ajax(apiUrlReviewAll, {
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    success: function (data) {
                        const result = data.data;
                        let str = '';
                        for (let i = result.length - 1; i >= 0; i--) {
                            if (result[i].tourId === tourId) {
                                let userDisplayName;
                                let srcPhoto;
                                const apiUrlUser = `http://api.nibles-tour.ga/user/${result[i].userId}`;
                                $.ajax(apiUrlUser, {
                                    type: "GET",
                                    contentType: "application/json",
                                    dataType: "json",
                                    async: false,
                                    success: function (user) {
                                        userDisplayName = user.data.displayName;
                                        srcPhoto = user.data.photo;
                                    }
                                });
                                let mainPhoto = '';
                                if (srcPhoto !== "") {
                                    mainPhoto += `http://api.nibles-tour.ga/${srcPhoto}`;
                                } else {
                                    mainPhoto += 'images/none_avatar.png';
                                }
                                str += `
                        <div>
                            <!-- Left -->
                            <div class="row">
                                <div style="text-align: center;" class="col-md-2">
                                    <img style="border-radius: 50%!important;max-height: 80px; border:2px solid lavender;"
                                        src="${mainPhoto}">
                                    <p><b>${userDisplayName}</b></p>
                                </div>
                                <!-- Body -->
                                <div class="col-md-10">
                                    <div class="row">
                                        <!-- Star -->
                                        <div class="col-md-12">
                                            <div id="rating-view-${result[i]._id}" class="rating" style="max-height:50px;">
                                                <input type="radio" name="rating${i}" value="5" id="five-star-view-${result[i]._id}">
                                                <label for="five-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="4" id="four-star-view-${result[i]._id}">
                                                <label for="four-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="3" id="three-star-view-${result[i]._id}">
                                                <label for="three-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="2" id="two-star-view-${result[i]._id}">
                                                <label for="two-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="1" id="one-star-view-${result[i]._id}">
                                                <label for="one-star-view-${result[i]._id}"><span>&#9733</span></label>
                                            </div>
                                        </div>
                                        <!-- Comment -->
                                        <div class="col-md-12">
                                            <textarea id="userComment-view-${result[i]._id}" class="form-control ng-pristine ng-invalid ng-touched" readonly>${result[i].comment}</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        `;
                                $("#listReview").html(str);
                                for (let i = 0; i < result.length; i++) {
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("disabled", true);
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("disabled", true);
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("disabled", true);
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("disabled", true);
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("disabled", true);
                                    switch (result[i].rating) {
                                        case 1:
                                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                            break;
                                        case 2:
                                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                            break;
                                        case 3:
                                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                            break;
                                        case 4:
                                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                            break;
                                        case 5:
                                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                            break;
                                    }
                                }

                            }
                        }
                        if (str === '') {
                            str += 'Not comment!';
                            $("#listReview").html(str);
                        }
                    }
                });
            } else {
                const apiUrl = `http://api.nibles-tour.ga/user/${dataLogin.userId}`;
                $.ajax(apiUrl, {
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    headers: {
                        Authorization: 'Bearer ' + dataLogin.token
                    }, success: function (result) {
                        const url = new URL(window.location.href);
                        const searchParam = new URLSearchParams(url.search);
                        const tourId = searchParam.get("id");
                        const data = result.data;
                        let imgSrc = '';
                        if (data.photo === "") {
                            imgSrc += 'images/none_avatar.png';
                        } else {
                            imgSrc += `http://api.nibles-tour.ga/${data.photo}`;
                        }
                        str += `
                        <ul class="navbar-nav navbar-left">
                        <li class="nav-item dropdown no-arrow">
                            <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle"
                                    href="#"><img class="img-profile rounded-circle" src="${imgSrc}" style="max-width: 40px;border-radius: 50%!important;">   <span>${data.displayName}</span></a>
                            <ul class="dropdown-menu" style="background-color: white;color: gray">
                                <li><a href="myaccount.html">
                                    Profile
                                </a></li>
                                <li><a onclick="killToken()" href="login.html">
                                    Logout
                                </a></li>
                            </ul>
                        </li>
                        </li>
                        </ul>
                        `;
                        $("#login").html(str);
                        formComment += `
                        <form>
                            <input id="userIdComment" type="hidden" name="userId" value="${data.id}">
                            <input id="tourIdComment" type="hidden" name="tourId" value="${tourId}">
                            <div class="row">
                                <div style="text-align: center;" class="col-md-2">
                                    <img style="border-radius: 50%!important;max-height: 80px; border:2px solid lavender;"
                                        src="${imgSrc}">
                                    <p><b>${data.displayName}</b></p>
                                    <div class="rating" style="max-height:50px;">
                                        <input type="radio" name="rating-create" value="5" id="five-star-create">
                                        <label for="five-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="4" id="four-star-create">
                                        <label for="four-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="3" id="three-star-create">
                                        <label for="three-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="2" id="two-star-create">
                                        <label for="two-star-create"><span>&#9733</span></label>
                                        <input type="radio" name="rating-create" value="1" id="one-star-create">
                                        <label for="one-star-create"><span>&#9733</span></label>
                                    </div>
                                </div>
                                <div class="col-md-10">
                                    <textarea id="userComment-create" class="form-control ng-pristine ng-invalid ng-touched"></textarea>
                                    <button type="button" class="btn btn-success" onclick="comment()">Comment</button>
                                </div>
                            </div>
                        </form>
                        `;
                        $("#formComment").html(formComment);
                        $(`#one-star-create`).prop('checked', true);
                    }
                });
                const apiUrlReviewAll = 'http://api.nibles-tour.ga/review/s';
                $.ajax(apiUrlReviewAll, {
                    type: "GET",
                    contentType: "application/json",
                    dataType: "json",
                    success: function (data) {
                        const result = data.data;
                        let str = '';
                        for (let i = result.length - 1; i >= 0; i--) {
                            if (result[i].tourId === tourId) {
                                let userDisplayName;
                                let srcPhoto;
                                const apiUrlUser = `http://api.nibles-tour.ga/user/${result[i].userId}`;
                                $.ajax(apiUrlUser, {
                                    type: "GET",
                                    contentType: "application/json",
                                    dataType: "json",
                                    async: false,
                                    success: function (user) {
                                        userDisplayName = user.data.displayName;
                                        srcPhoto = user.data.photo;
                                    }
                                });
                                let mainPhoto = '';
                                if (srcPhoto !== "") {
                                    mainPhoto += `http://api.nibles-tour.ga/${srcPhoto}`;
                                } else {
                                    mainPhoto += 'images/none_avatar.png';
                                }
                                str += `
                        <div>
                            <!-- Left -->
                            <div class="row">
                                <div style="text-align: center;" class="col-md-2">
                                    <img style="border-radius: 50%!important;max-height: 80px; border:2px solid lavender;"
                                    src="${mainPhoto}">
                                    <p><b>${userDisplayName}</b></p>
                                </div>
                                <!-- Body -->
                                <div class="col-md-10">
                                    <div class="row">
                                        <!-- Star -->
                                        <div class="col-md-12">
                                            <div id="rating-view-${result[i]._id}" class="rating" style="max-height:50px;">
                                                <input type="radio" name="rating${i}" value="5" id="five-star-view-${result[i]._id}">
                                                <label for="five-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="4" id="four-star-view-${result[i]._id}">
                                                <label for="four-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="3" id="three-star-view-${result[i]._id}">
                                                <label for="three-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="2" id="two-star-view-${result[i]._id}">
                                                <label for="two-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="1" id="one-star-view-${result[i]._id}">
                                                <label for="one-star-view-${result[i]._id}"><span>&#9733</span></label>
                                            </div>
                                        </div>`;
                                if (result[i].userId === dataLogin.userId) {
                                    str += `
                                    <!-- Comment -->
                                        <div class="col-md-12">
                                            <textarea id="userComment-view-${result[i]._id}" class="form-control ng-pristine ng-invalid ng-touched" readonly>${result[i].comment}</textarea>
                                            <div id="change-button-${result[i]._id}">
                                                <button class="btn btn-primary" onclick="getReviewId('${result[i]._id}', '${i}', 'update')">Edit</button>
                                                <button class="btn btn-danger" onclick="getReviewId('${result[i]._id}', '${i}', 'delete')" data-toggle="modal" data-target="#exampleModalCenter-Delete">Delete</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        `;
                                } else {
                                    str += `
                                    <!-- Comment -->
                                        <div class="col-md-12">
                                            <textarea id="userComment-view-${result[i]._id}" class="form-control ng-pristine ng-invalid ng-touched" readonly>${result[i].comment}</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        `;
                                }
                            }
                        }
                        if (str === '') {
                            str += 'Not comment!';
                        }
                        $("#listReview").html(str);
                        for (let i = 0; i < result.length; i++) {
                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("disabled", true);
                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("disabled", true);
                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("disabled", true);
                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("disabled", true);
                            $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("disabled", true);
                            switch (result[i].rating) {
                                case 1:
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                    break;
                                case 2:
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                    break;
                                case 3:
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                    break;
                                case 4:
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                    break;
                                case 5:
                                    $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                    break;
                            }
                        }
                    }
                });
            }
        });
    </script>

    <script>
        function comment() {
            const url = new URL(window.location.href);
            const searchParam = new URLSearchParams(url.search);
            const tourId = searchParam.get("id");
            const dataLogin = JSON.parse(localStorage.getItem("dataLoginClient"));
            if (!dataLogin) {
                alert("Cần đăng nhập để đặt bình luận!");
            } else {
                const review = {};
                review.userId = $("#userIdComment").val();
                review.tourId = $("#tourIdComment").val();
                review.rating = $('input[name="rating-create"]:checked').val();
                const comment = $("#userComment-create").val();
                if (comment !== '') {
                    review.comment = comment;
                    const apiUrlReviewCreate = `http://api.nibles-tour.ga/review`;
                    $.ajax(apiUrlReviewCreate, {
                        type: "POST",
                        data: JSON.stringify(review),
                        contentType: "application/json",
                        dataType: "json",
                        headers: {
                            Authorization: 'Bearer ' + dataLogin.token
                        },
                        success: function async(data) {
                            const apiUrlReviewAll = 'http://api.nibles-tour.ga/review/s';
                            $.ajax(apiUrlReviewAll, {
                                type: "GET",
                                contentType: "application/json",
                                dataType: "json",
                                headers: {
                                    Authorization: 'Bearer ' + dataLogin.token
                                },
                                success: function (review) {
                                    const result = review.data;
                                    let str = '';
                                    for (let i = result.length - 1; i >= 0; i--) {
                                        if (result[i].tourId === tourId) {
                                            let userDisplayName;
                                            let srcPhoto;
                                            const apiUrlUser = `http://api.nibles-tour.ga/user/${result[i].userId}`;
                                            $.ajax(apiUrlUser, {
                                                type: "GET",
                                                contentType: "application/json",
                                                dataType: "json",
                                                headers: {
                                                    Authorization: 'Bearer ' + dataLogin.token
                                                },
                                                async: false,
                                                success: function (user) {
                                                    userDisplayName = user.data.displayName;
                                                    srcPhoto = user.data.photo;
                                                }
                                            });
                                            let mainPhoto = '';
                                            if (srcPhoto !== "") {
                                                mainPhoto += `http://api.nibles-tour.ga/${srcPhoto}`;
                                            } else {
                                                mainPhoto += 'images/none_avatar.png';
                                            }
                                            str += `
                        <div>
                            <!-- Left -->
                            <div class="row">
                                <div style="text-align: center;" class="col-md-2">
                                    <img style="border-radius: 50%!important;max-height: 80px; border:2px solid lavender;"
                                    src="${mainPhoto}">
                                    <p><b>${userDisplayName}</b></p>
                                </div>
                                <!-- Body -->
                                <div class="col-md-10">
                                    <div class="row">
                                        <!-- Star -->
                                        <div class="col-md-12">
                                            <div id="rating-view-${result[i]._id}" class="rating" style="max-height:50px;">
                                                <input type="radio" name="rating${i}" value="5" id="five-star-view-${result[i]._id}">
                                                <label for="five-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="4" id="four-star-view-${result[i]._id}">
                                                <label for="four-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="3" id="three-star-view-${result[i]._id}">
                                                <label for="three-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="2" id="two-star-view-${result[i]._id}">
                                                <label for="two-star-view-${result[i]._id}"><span>&#9733</span></label>
                                                <input type="radio" name="rating${i}" value="1" id="one-star-view-${result[i]._id}">
                                                <label for="one-star-view-${result[i]._id}"><span>&#9733</span></label>
                                            </div>
                                        </div>`;
                                            if (result[i].userId === dataLogin.userId) {
                                                str += `
                                    <!-- Comment -->
                                        <div class="col-md-12">
                                            <textarea id="userComment-view-${result[i]._id}" class="form-control ng-pristine ng-invalid ng-touched" readonly>${result[i].comment}</textarea>
                                            <div id="change-button-${result[i]._id}">
                                                <button class="btn btn-primary" onclick="getReviewId('${result[i]._id}', '${i}', 'update')">Edit</button>
                                                <button class="btn btn-danger" onclick="getReviewId('${result[i]._id}', '${i}', 'delete')" data-toggle="modal" data-target="#exampleModalCenter-Delete">Delete</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        `;
                                            } else {
                                                str += `
                                    <!-- Comment -->
                                        <div class="col-md-12">
                                            <textarea id="userComment-view-${result[i]._id}" class="form-control ng-pristine ng-invalid ng-touched" readonly>${result[i].comment}</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        `;
                                            }
                                        }
                                    }
                                    if (str === '') {
                                        str += 'Not comment!';
                                    }
                                    $("#listReview").html(str);
                                    for (let i = 0; i < result.length; i++) {
                                        $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("disabled", true);
                                        $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("disabled", true);
                                        $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("disabled", true);
                                        $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("disabled", true);
                                        $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("disabled", true);
                                        switch (result[i].rating) {
                                            case 1:
                                                $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="one-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                                break;
                                            case 2:
                                                $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="two-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                                break;
                                            case 3:
                                                $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="three-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                                break;
                                            case 4:
                                                $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="four-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                                break;
                                            case 5:
                                                $(`#rating-view-${result[i]._id} > input:radio[name="rating${i}"][id="five-star-view-${result[i]._id}"]`).attr("checked", "checked");
                                                break;
                                        }
                                    }
                                    $(`#one-star-create`).prop('checked', true);
                                    $("textarea#userComment-create").val('');
                                }
                            });
                        },
                        error: function (error) {
                            alert(error.responseJSON.message);
                        }
                    });
                } else {
                    alert("Chưa nhập bình luận!");
                }
            }
        }
    </script>

    <script>
        function getReviewId(id, index, action) {
            localStorage.setItem("reviewId", id);
            if (action === 'update') {
                $(`#userComment-view-${id}`).attr("readonly", false);
                $(`#rating-view-${id} > input:radio[name="rating${index}"][id="one-star-view-${id}"]`).attr("disabled", false);
                $(`#rating-view-${id} > input:radio[name="rating${index}"][id="two-star-view-${id}"]`).attr("disabled", false);
                $(`#rating-view-${id} > input:radio[name="rating${index}"][id="three-star-view-${id}"]`).attr("disabled", false);
                $(`#rating-view-${id} > input:radio[name="rating${index}"][id="four-star-view-${id}"]`).attr("disabled", false);
                $(`#rating-view-${id} > input:radio[name="rating${index}"][id="five-star-view-${id}"]`).attr("disabled", false);
                let str = `
                    <button class="btn btn-success" onclick="updateReview('${id}', '${index}')" >Edit</button>
                    <button class="btn btn-warning" onclick="reverse()">Cancel</button>
                `;
                $(`#change-button-${id}`).html(str);
            }
        }

        function updateReview(id, index) {
            const url = new URL(window.location.href);
            const searchParam = new URLSearchParams(url.search);
            const tourId = searchParam.get("id");
            const dataLogin = JSON.parse(localStorage.getItem("dataLoginClient"));
            const review = {};
            review.userId = dataLogin.userId;
            review.tourId = tourId;
            review.rating = $(`input[name="rating${index}"]:checked`).val();
            const comment = $(`#userComment-view-${id}`).val();
            if (comment !== '') {
                review.comment = comment;
                const apiUrlReviewUpdate = `http://api.nibles-tour.ga/review/${id}`;
                $.ajax(apiUrlReviewUpdate, {
                    type: "PUT",
                    data: JSON.stringify(review),
                    contentType: "application/json",
                    dataType: "json",
                    headers: {
                        Authorization: 'Bearer ' + dataLogin.token
                    },
                    success: function (review) {
                        alert(review.message);
                        window.location.reload();
                    }
                });
            } else {
                alert("Chưa nhập bình luận!");
            }
        }

        function reverse() {
            window.location.reload();
        }

        function deleteComment() {
            const url = new URL(window.location.href);
            const searchParam = new URLSearchParams(url.search);
            const tourId = searchParam.get("id");
            const apiUrl = `http://api.nibles-tour.ga/review/${localStorage.getItem("reviewId")}`;
            const authenticate = JSON.parse(localStorage.getItem("dataLoginClient"));
            $.ajax(apiUrl, {
                type: "DELETE",
                contentType: "application/json",
                dataType: "json",
                headers: {
                    Authorization: 'Bearer ' + authenticate.token
                },
                success: function async(data) {
                    localStorage.removeItem("reviewId");
                    window.location.reload();
                },
                error: function (error) {
                    alert(error.responseJSON.message);
                    localStorage.removeItem("reviewId");
                }
            });
        }
    </script>

    <script>
        $(document).ready(function () {
            const url = new URL(window.location.href);
            const searchParam = new URLSearchParams(url.search);
            const id = searchParam.get("id");
            const searchFilterURL = `http://api.nibles-tour.ga/tour/${id}`;
            $.ajax(searchFilterURL, {
                type: "GET",
                contentType: "application/json",
                dataType: "json"
            }).done(function (result) {
                let str = "";
                const data = result.data;
                if (data) {
                    str += `<div class="col-md-6">
                        <div class="booking-details">
                            <div class="col-md-5">
                                <img src="http://api.nibles-tour.ga/${data.photo}"/>
                            </div>
                            <div class="col-md-7">
                                <h3 class="Default-clr">Details</h3>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Tour Name</h5>
                                    <p>${data.tourName}</p>
                                </div>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Location</h5>
                                    <p>${data.location}</p>
                                </div>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Open Date</h5>
                                    <p>${new Date(Date.parse(data.startedDate)).getDate()}/${new Date(Date.parse(data.startedDate)).getMonth() + 1}/${new Date(Date.parse(data.startedDate)).getFullYear()}</p>
                                </div>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Close Date</h5>
                                    <p>${new Date(Date.parse(data.endDate)).getDate()}/${new Date(Date.parse(data.endDate)).getMonth() + 1}/${new Date(Date.parse(data.endDate)).getFullYear()}</p>
                                </div>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Time</h5>
                                    <p>${data.time} day</p>
                                </div>
                                <div class="col-md-6 padding-left-0">
                                    <h5>Seat</h5>
                                    <p>${data.emptySeat} seat</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="booking-other-details">
                            <h3 class="Default-clr">Other Details</h3>
                            <dl class="other-details">
                                <dt class="feature">Tour Type</dt>
                                <dd class="value">${data.typeTours[0].type}</dd>
                                <dt class="feature">Price</dt>
                                <dd class="value">${Number(data.price).toLocaleString()} VND</dd>
                                <dt class="feature">Child</dt>
                                <dd class="value">${data.child} person</dd>
                                <dt class="feature">Adult</dt>
                                <dd class="value">${data.adult} person</dd>
                            </dl>
                        </div>
                    </div>
                    <section id="tour-booking" class="gray-area section-padding">
                        <div class="container">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="section-title">
                                        <h2>Descriptions</h2>
                                        <div class="title-separator-outer ">
                                            <div class="title-separator bg-primary style-liner"></div>
                                        </div>
                                        <p>${data.note}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>`;
                    $("#tourDetail").html(str);
                    $("#adult-booking").val("");
                    $("#child-booking").val("");
                    localStorage.setItem("booking", JSON.stringify(data));
                } else {
                    $("#tourDetail").html(`<h3>Not Fount!</h3>`);
                }
            });
        });
    </script>
    <script>
        $("#adult-booking").change(function (e) {
            const adult = e.target.value;
            const child = $("#child-booking").val();
            const booking = JSON.parse(localStorage.getItem("booking"));
            let total = Number($("#total-booking").val()) || 0;
            if (adult) {
                total = Number(adult) * Number(booking.price) + Number(child) * Number(booking.price * 0.8);
            }
            $("#total-booking").val(total);
        });
        $("#child-booking").change(function (e) {
            const child = e.target.value;
            const adult = $("#adult-booking").val();
            const booking = JSON.parse(localStorage.getItem("booking"));
            let total = Number($("#total-booking").val()) || 0;
            if (child) {
                total = Number(adult) * Number(booking.price) + Number(child) * Number(booking.price * 0.8);
            }
            $("#total-booking").val(total);
        });
    </script>
    <script>
        function booking(event) {
            event.preventDefault();
            const dataLogin = localStorage.getItem("dataLoginClient");
            if (dataLogin) {
                let adult, child;

                let adultBooking = document.getElementById("adult-booking");
                adultBooking = adultBooking.options[adultBooking.selectedIndex];
                if (adultBooking) {
                    adult = adultBooking.value;
                }

                let childBooking = document.getElementById("child-booking");
                childBooking = childBooking.options[childBooking.selectedIndex];
                if (childBooking) {
                    child = childBooking.value;
                }

                const applyDate = document.getElementById("applyDate-booking").value;
                if (!applyDate) {
                    return;
                }

                const totalPrice = document.getElementById("total-booking").value;

                const booking = JSON.parse(localStorage.getItem("booking"));
                booking.adultBooking = Number(adult);
                booking.childBooking = Number(child);
                booking.applyDateBooking = applyDate;
                booking.totalBooking = Number(totalPrice);

                localStorage.setItem("booking", JSON.stringify(booking));

                document.location.pathname = '/confirmation.html';
            } else {
                alert("Cần đăng nhập để đặt tour!");
            }
        }
    </script>
    <script>
        function killToken() {
            localStorage.removeItem("dataLoginClient");
            localStorage.removeItem("booking");
            document.location.pathname = '/';
        };
    </script>
</body>


<!-- Mirrored from shmai.com/preview/travelco/booking-form.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 26 Sep 2018 04:24:10 GMT -->

</html>